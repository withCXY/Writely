<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Read-only Text Translation Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            border: 2px solid #ddd;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            background-color: #f8f9fa;
        }
        .editable-section {
            border: 2px solid #4285f4;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            background-color: #fff;
        }
        .info {
            background-color: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        h2 {
            color: #333;
            border-bottom: 2px solid #4285f4;
            padding-bottom: 10px;
        }
        .feature-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .comparison-item {
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        .readonly {
            background-color: #fff3cd;
            border-color: #ffeaa7;
        }
        .editable {
            background-color: #d1ecf1;
            border-color: #bee5eb;
        }
    </style>
</head>
<body>
    <h1>ğŸŒ Read-only Text Translation Test</h1>
    
    <div class="info">
        <h3>âœ¨ Feature Overview:</h3>
        <p>This page tests the <strong>read-only text translation</strong> feature. When you select text in read-only areas, the AI Assistant should:</p>
        <ul>
            <li>ğŸ” <strong>Detect read-only text</strong> and show appropriate menu options</li>
            <li>ğŸŒ <strong>Show translation submenu</strong> with language options</li>
            <li>ğŸ“‹ <strong>Display translation result</strong> in a popup window (not replace original text)</li>
            <li>ğŸ“„ <strong>Provide copy button</strong> to copy translation to clipboard</li>
        </ul>
    </div>

    <div class="feature-comparison">
        <div class="comparison-item readonly">
            <h4>ğŸ“– Read-only Text Behavior</h4>
            <ul>
                <li>Shows "Translate â–¸" and "Close" only</li>
                <li>Translation result appears in popup</li>
                <li>Original text remains unchanged</li>
                <li>Copy button provided</li>
            </ul>
        </div>
        <div class="comparison-item editable">
            <h4>âœï¸ Editable Text Behavior</h4>
            <ul>
                <li>Shows full menu (Translate, Rewrite, Tone)</li>
                <li>Translation directly replaces text</li>
                <li>Original text is modified</li>
                <li>No popup window</li>
            </ul>
        </div>
    </div>

    <h2>Test Areas</h2>
    
    <h3>1. Read-only Text Areas (Gray Background)</h3>
    
    <div class="test-section">
        <h4>English Text for Translation</h4>
        <p>Hello, this is a sample English text that you can select and translate to other languages. The AI Assistant should detect this as read-only text and show the translation result in a popup window instead of replacing the original text.</p>
    </div>

    <div class="test-section">
        <h4>Chinese Text for Translation</h4>
        <p>ä½ å¥½ï¼Œè¿™æ˜¯ä¸€æ®µä¸­æ–‡ç¤ºä¾‹æ–‡æœ¬ï¼Œä½ å¯ä»¥é€‰æ‹©å®ƒå¹¶ç¿»è¯‘æˆå…¶ä»–è¯­è¨€ã€‚AIåŠ©æ‰‹åº”è¯¥æ£€æµ‹åˆ°è¿™æ˜¯åªè¯»æ–‡æœ¬ï¼Œå¹¶åœ¨å¼¹å‡ºçª—å£ä¸­æ˜¾ç¤ºç¿»è¯‘ç»“æœï¼Œè€Œä¸æ˜¯æ›¿æ¢åŸå§‹æ–‡æœ¬ã€‚</p>
    </div>

    <div class="test-section">
        <h4>Spanish Text for Translation</h4>
        <p>Hola, este es un texto de ejemplo en espaÃ±ol que puedes seleccionar y traducir a otros idiomas. El Asistente de IA deberÃ­a detectar esto como texto de solo lectura y mostrar el resultado de la traducciÃ³n en una ventana emergente.</p>
    </div>

    <div class="test-section">
        <h4>Japanese Text for Translation</h4>
        <p>ã“ã‚“ã«ã¡ã¯ã€ã“ã‚Œã¯ä»–ã®è¨€èªã«ç¿»è¨³ã§ãã‚‹ã‚µãƒ³ãƒ—ãƒ«ã®æ—¥æœ¬èªãƒ†ã‚­ã‚¹ãƒˆã§ã™ã€‚AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã¯ã“ã‚Œã‚’èª­ã¿å–ã‚Šå°‚ç”¨ãƒ†ã‚­ã‚¹ãƒˆã¨ã—ã¦æ¤œå‡ºã—ã€å…ƒã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ç½®ãæ›ãˆã‚‹ä»£ã‚ã‚Šã«ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«ç¿»è¨³çµæœã‚’è¡¨ç¤ºã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>
    </div>

    <h3>2. Editable Text Areas (Blue Border, White Background)</h3>
    
    <textarea class="editable-section" placeholder="Type or paste text here for testing editable text translation...">
This is editable text. When you select text here, the AI Assistant should show the full menu with Translate, Rewrite, and Tone options. Translation will directly replace the selected text.
    </textarea>
    
    <div class="editable-section" contenteditable="true">
        This is a contenteditable div. Select this text to test editable text behavior. The translation should directly replace the selected text instead of showing a popup.
    </div>

    <div class="info">
        <h3>ğŸ§ª Testing Instructions:</h3>
        <ol>
            <li><strong>Test Read-only Translation:</strong>
                <ul>
                    <li>Select text in any gray background area</li>
                    <li>Click the AI Assistant icon</li>
                    <li>Verify menu shows only "Translate â–¸" and "Close"</li>
                    <li>Click "Translate â–¸" and select a target language</li>
                    <li>Verify translation appears in popup window</li>
                    <li>Verify original text remains unchanged</li>
                    <li>Test the "Copy Translation" button</li>
                </ul>
            </li>
            <li><strong>Test Editable Translation (for comparison):</strong>
                <ul>
                    <li>Select text in blue border areas</li>
                    <li>Verify menu shows full options</li>
                    <li>Test that translation replaces original text</li>
                </ul>
            </li>
        </ol>
        
        <h3>âœ… Expected Results:</h3>
        <ul>
            <li><strong>Read-only areas</strong>: Translation popup with copy button</li>
            <li><strong>Editable areas</strong>: Direct text replacement</li>
            <li><strong>Menu differences</strong>: Read-only shows fewer options</li>
            <li><strong>Consistent behavior</strong>: Same translation quality in both modes</li>
        </ul>
    </div>

    <script>
        console.log('Read-only translation test page loaded');
        
        // Monitor selection changes for debugging
        document.addEventListener('selectionchange', function() {
            const selection = window.getSelection();
            const selectedText = selection.toString().trim();
            if (selectedText && selectedText.length > 3) {
                const range = selection.getRangeAt(0);
                const element = range.commonAncestorContainer.nodeType === Node.TEXT_NODE 
                    ? range.commonAncestorContainer.parentElement 
                    : range.commonAncestorContainer;
                
                // Check if element is editable
                const isEditable = element.isContentEditable || 
                                 element.tagName === 'TEXTAREA' || 
                                 element.tagName === 'INPUT';
                
                console.log('Selected text:', selectedText.substring(0, 30) + '...');
                console.log('Element type:', element.tagName);
                console.log('Is editable:', isEditable);
                console.log('Should be read-only:', !isEditable);
            }
        });
    </script>
</body>
</html>